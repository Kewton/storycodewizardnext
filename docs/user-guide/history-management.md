# 履歴管理

StoryCodeWizardの履歴管理機能の詳細な使用方法を説明します。

## 履歴管理の概要

履歴管理機能では以下が可能です：

- プロジェクトごとのチャット履歴表示
- 履歴の詳細確認
- コンテンツのダウンロード
- プロジェクトへのコード反映
- 履歴の削除

## インターフェース

### 左側パネル（履歴一覧）
- **プロジェクト選択**: 履歴を閲覧したいプロジェクトを選択します。
  - **プロジェクト説明**: 選択したプロジェクトの概要や目的が表示され、コンテキストの把握を助けます。
- **履歴リスト**: 選択したプロジェクトのチャット履歴が一覧表示されます。
  - 各項目には「実行時刻 | モデル名」が表示され、識別しやすくなっています。
  - リストは新しいものから順に表示されます。

### 右側パネル（会話詳細）
- **タイトル**: 「会話詳細」と表示されます。
- **アクションボタン**:
  - **Delete History**: 選択中の履歴を削除します。
  - **Download Your Context**: ユーザーが入力した内容（システムプロンプト含む）をMarkdownファイルとしてダウンロードします。
  - **Download Agent Context**: AIが応答した内容をMarkdownファイルとしてダウンロードします。
  - **プロジェクトに反映**: AIの応答内容を現在のプロジェクトに適用します。
- **詳細表示エリア**: 選択した履歴の具体的な内容が4つのセクションで表示されます。
  1.  **① Coding Agent Role**: AIに設定されたシステムロール（プロンプト）の内容。
  2.  **② Youre Request**: ユーザーが最初に入力した要求。
  3.  **③ Your Context**: ユーザーがAIに送信した完全なコンテキスト（システムプロンプトやファイル情報を含む）。
  4.  **④ Agent Context**: AIからの完全な応答内容。
  - 各セクションの内容はMarkdown形式で表示され、コードブロックなどはシンタックスハイライトされます。
  - 各セクションは必要に応じて高さが調整されます（①と②は高さ固定、③と④は可変）。

## 基本的な使い方

1. **プロジェクト選択**: 左側パネル上部のコンボボックスから、履歴を確認したいプロジェクトを選択します。選択したプロジェクトの説明が表示されます。
2. **履歴選択**: 左側パネルの履歴リストから、詳細を確認したい履歴項目をクリックします。
3. **詳細確認**: 右側パネルに選択した履歴の詳細な内容（システムロール、ユーザー入力、AI応答）が表示されます。
4. **アクション実行 (任意)**:
   - **削除**: 不要な履歴は「Delete History」ボタンで削除します（確認ダイアログが表示されます）。
   - **ダウンロード**: 「Download Your Context」または「Download Agent Context」ボタンで、ユーザー入力やAI応答をMarkdownファイルとして保存します。
   - **プロジェクト反映**: 「プロジェクトに反映」ボタンで、AIの応答をプロジェクトファイルに適用します。

## 表示形式

### 履歴リスト
- **フォーマット**: `YYYY-MM-DD_HH:MM:SS | <モデル名>`
- **フォント**: 視認性を高めるため、大きめのフォントサイズを使用しています。

### 詳細表示
- **4セクション構成**:
  1. **Coding Agent Role**: AIの役割設定や前提条件。
  2. **Youre Request**: ユーザーの初期リクエスト。
  3. **Your Context**: ユーザーからの全入力情報。
  4. **Agent Context**: AIからの全応答情報。
- **Markdownレンダリング**: すべてのテキストコンテンツはMarkdownとして解釈され、見出し、リスト、コードブロックなどが適切に表示されます。
- **高さ調整**:
  - 「Coding Agent Role」と「Youre Request」セクションは、内容の長さに応じて一定の高さまで表示されます（折りたたみ可能）。
  - 「Your Context」と「Agent Context」セクションは、内容全体を表示するために可変の高さになります。

## 注意点
- 履歴を削除すると元に戻すことはできません。慎重に操作してください。
- プロジェクト反映機能は、既存のファイルを上書きする可能性があります。使用前に内容をよく確認してください。
